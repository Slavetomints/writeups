<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://slavetomints.github.io/writeups/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="https://slavetomints.github.io/writeups/favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
  <title>Scavenger Hunt</title>
</head>
<body>

  <nav class="green-border" id="larger-margins">
    <h1>Slavetomints' Writeups</h1>
    <p><i>A collection of my writeups from various CTF'S</i></p>
    <ul>
      <li><a href="https://slavetomints.github.io/writeups/index.html">Home</a></li>
      <li><a href="https://slavetomints.github.io/writeups/writeups.html">Writeups</a></li>
      <li><a href="https://slavetomints.github.io/index.html">About Me</a></li>
    </ul>
  </nav>

  <div class="green-border">
    <p><a href="https://slavetomints.github.io/writeups/writeups/training/training.html">Training</a> / <a href="https://slavetomints.github.io/writeups/writeups/training/picoctf/picoctf.html">picoCTF</a> / <a href="https://slavetomints.github.io/writeups/writeups/training/picoctf/web-exploitation/web-exploitation.html">Web Exploitation</a> / <a href="https://slavetomints.github.io/writeups/writeups/training/picoctf/web-exploitation/scavenger-hunt/scavenger-hunt.html">Scavenger Hunt</a></p>
    <md-block>
      # Scavenger Hunt

      Challenge description:
      
      > There is some interesting information hidden around this site http://mercury.picoctf.net:27278/. Can you find it
      
      Alrighty, sounds like we're gonna be going on quite the trip here. So let's get started off with checking the source code for `index.html`
      
      ## index.html
      
      ```html
      
      &lt;!DOCTYPE html&gt;
      &lt;html&gt;
        &lt;head&gt;
          &lt;title&gt;Scavenger Hunt&lt;/title&gt;
          &lt;link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto" rel="stylesheet"&gt;
          &lt;link rel="stylesheet" type="text/css" href="mycss.css"&gt;
          &lt;script type="application/javascript" src="myjs.js"&gt;&lt;/script&gt;
        &lt;/head&gt;
      
        &lt;body&gt;
          &lt;div class="container"&gt;
            &lt;header&gt;
          &lt;h1&gt;Just some boring HTML&lt;/h1&gt;
            &lt;/header&gt;
      
            &lt;button class="tablink" onclick="openTab('tabintro', this, '#222')" id="defaultOpen" style="background-color: rgb(34, 34, 34); --darkreader-inline-bgcolor: #1a1c1d;" data-darkreader-inline-bgcolor=""&gt;How&lt;/button&gt;
            &lt;button class="tablink" onclick="openTab('tababout', this, '#222')" style=""&gt;What&lt;/button&gt;
      
            &lt;div id="tabintro" class="tabcontent" style="display: block;"&gt;
              &lt;h3&gt;How&lt;/h3&gt;
              &lt;p&gt;How do you like my website?&lt;/p&gt;
            &lt;/div&gt;
      
            &lt;div id="tababout" class="tabcontent" style="display: none;"&gt;
              &lt;h3&gt;What&lt;/h3&gt;
              &lt;p&gt;I used these to make this site: &lt;br&gt;
                HTML &lt;br&gt;
                CSS &lt;br&gt;
                JS (JavaScript)
              &lt;/p&gt;
        &lt;!-- Here's the first part of the flag: picoCTF{t --&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/body&gt;
      &lt;/html&gt;
      
      ```
      
      Looks like we have part of the flag now! They always like to hide stuff in the comments but this has real life application too. THings get hardcoded all of the time. Secrets, keys, login information, developers get lazy sometimes and this is how they get burned for that. Lets go check the `mycss.css` now.
      
      ## mycss.css
      
      ```css
      
      div.container {
          width: 100%;
      }
      
      header {
          background-color: black;
          padding: 1em;
          color: white;
          clear: left;
          text-align: center;
      }
      
      body {
          font-family: Roboto;
      }
      
      h1 {
          color: white;
      }
      
      p {
          font-family: "Open Sans";
      }
      
      .tablink {
          background-color: #555;
          color: white;
          float: left;
          border: none;
          outline: none;
          cursor: pointer;
          padding: 14px 16px;
          font-size: 17px;
          width: 50%;
      }
      
      .tablink:hover {
          background-color: #777;
      }
      
      .tabcontent {
          color: #111;
          display: none;
          padding: 50px;
          text-align: center;
      }
      
      #tabintro { background-color: #ccc; }
      #tababout { background-color: #ccc; }
      
      /* CSS makes the page look nice, and yes, it also has part of the flag. Here's part 2: h4ts_4_l0 */
      
      ```
      
      Lets keep going! The JavaScript is housed in `myjs.js`
      
      ## myjs.js
      
      ```javascript
      
      function openTab(tabName,elmnt,color) {
          var i, tabcontent, tablinks;
          tabcontent = document.getElementsByClassName("tabcontent");
          for (i = 0; i &lt; tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
          }
          tablinks = document.getElementsByClassName("tablink");
          for (i = 0; i &lt; tablinks.length; i++) {
        tablinks[i].style.backgroundColor = "";
          }
          document.getElementById(tabName).style.display = "block";
          if(elmnt.style != null) {
        elmnt.style.backgroundColor = color;
          }
      }
      
      window.onload = function() {
          openTab('tabintro', this, '#222');
      }
      
      /* How can I keep Google from indexing my website? */
      
      ```
      
      Hm, this isn't as easy as we thought. [RFC 9309](https://www.rfc-editor.org/rfc/rfc9309.txt) Defines the **Robots Exclusion Protocol** which says:
      
      >    This document applies to services that provide resources that clients
      >   can access through URIs as defined in [RFC3986].  For example, in the
      >   context of HTTP, a browser is a client that displays the content of a
      >   web page.
      >
      >   Crawlers are automated clients.  Search engines, for instance, have
      >   crawlers to recursively traverse links for indexing as defined in
      >   [RFC8288].
      >
      >   It may be inconvenient for service owners if crawlers visit the
      >   entirety of their URI space.  This document specifies the rules
      >   originally defined by the "Robots Exclusion Protocol" [ROBOTSTXT]
      >   that crawlers are requested to honor when accessing URIs.
      >
      >   These rules are not a form of access authorization.
      > 
      >   Internet Engineering Task Force (IETF) September 2022
      > 
      
      In basic terms, you can stop crawlers by defining rules in a file called `/robots.txt`, so I think thats a worthy next stop. Before we go, just know that `/robots.txt` is not a valid security measure. It is based on User-Agents, which are easily spoofable. The RFC even mentions this:
      
      >  The Robots Exclusion Protocol is not a substitute for valid content
      >  security measures.  Listing paths in the robots.txt file exposes them
      >  publicly and thus makes the paths discoverable.  To control access to
      >  the URI paths in a robots.txt file, users of the protocol should
      >  employ a valid security measure relevant to the application layer on
      >  which the robots.txt file is served -- for example, in the case of
      >  HTTP, HTTP Authentication as defined in [RFC9110].
      
      ## /robots.txt
      
      ```text
      
      User-agent: *
      Disallow: /index.html
      # Part 3: t_0f_pl4c
      # I think this is an apache server... can you Access the next flag?
      
      ```
      
      Hm, now we need to take into consideration the default pages on an apache server. A quick google search tells us that `/.htaccess` is used to ["make configuration changes on a per-directory basis"](https://httpd.apache.org/docs/2.4/howto/htaccess.html) So maybe that has something for us?
      
      ## /.htaccess
      
      ```text
      
      # Part 4: 3s_2_lO0k
      # I love making websites on my Mac, I can Store a lot of information there.
      
      ```
      
      Okay, keeping with the theme of files lets talke about `/.DS_Store`. This file stores ["custom attributes of its containing folder, such as folder view options, icon positions, and other visual information."](https://en.wikipedia.org/wiki/.DS_Store#).
      
      ## ./DS_Store
      
      ```text
      
      Congrats! You completed the scavenger hunt. Part 5: _a69684fd}
      
      ```
      
      Finally! That took long enough!
      
      FLAG: `picoCTF{th4ts_4_l0t_0f_pl4c3s_2_lO0k_a69684fd}`
    </md-block>
  </div>
  
  <nav class="green-border" id="larger-margins">
    <ul>
      <li><a href="https://slavetomints.github.io/writeups/index.html">Home</a></li>
      <li><a href="https://slavetomints.github.io/writeups/writeups.html">Writeups</a></li>
      <li><a href="https://slavetomints.github.io/index.html">About Me</a></li>
    </ul>
  </nav>

  <script src="https://cdn.jsdelivr.net/npm/marked@5.1.2/marked.min.js"></script>
  <script type="module" src="https://md-block.verou.me/md-block.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-ruby.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
</body>
</html>