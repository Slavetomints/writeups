<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://slavetomints.github.io/writeups/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="https://slavetomints.github.io/writeups/favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
  <title>dont-use-client-side</title>
</head>
<body>

  <nav class="green-border" id="larger-margins">
    <h1>Slavetomints' Writeups</h1>
    <p><i>A collection of my writeups from various CTF'S</i></p>
    <ul>
      <li><a href="https://slavetomints.github.io/writeups/index.html">Home</a></li>
      <li><a href="https://slavetomints.github.io/writeups/writeups.html">Writeups</a></li>
      <li><a href="https://slavetomints.github.io/about.html">About</a></li>
    </ul>
  </nav>

  <div class="green-border">
    <p><a href="https://slavetomints.github.io/writeups/writeups/training/training.html">Training</a> / <a href="https://slavetomints.github.io/writeups/writeups/training/picoctf/picoctf.html">picoCTF</a> / <a href="https://slavetomints.github.io/writeups/writeups/training/picoctf/web-exploitation/web-exploitation.html">Web Exploitation</a> / <a href="https://slavetomints.github.io/writeups/writeups/training/picoctf/web-exploitation/dont-use-client-side/dont-use-client-side.html">dont-use-client-side</a></p>
    <md-block>
      # dont-use-client-side

      Challenge description:
      
      > Can you break into this super secure portal? https://jupiter.challenges.picoctf.org/problem/37821/ (link) or http://jupiter.challenges.picoctf.org:37821
      
      So, lets check out this "secure portal"
      
      ![the portal](assets/image0.png)
      
      First things first when checking a webpage, always inspect it. Its possible to find all kinds of things in the source code for the web pages, and this site is no different. Navigate to the Debugger tab in developer tools and you'll see something that resembles a file tree on the left hand side of the window. We want to open the JavaScript file for this page, and for me thats in the `(index)` file.
      
      ![the code](assets/image1.png)
      
      Looks like we're going to have to discuss the `substring()` method in JavaScript. The [docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/substring) describe it as "The `substring()` method of String values returns the part of this string from the start index up to and excluding the end index, or to the end of the string if no end index is supplied." 
      
      The syntax is as follows:
      
      ```javascript
      
      substring(indexStart)
      substring(indexStart, indexEnd)
      ```
      
      So, now that we know all there is to know about substrings, lets look back at the code we're provided.
      
      ```javascript
      
      function verify() {
        checkpass = document.getElementById("pass").value;
        split = 4;
        if (checkpass.substring(0, split) == 'pico') {
          if (checkpass.substring(split*6, split*7) == 'a3c8') {
            if (checkpass.substring(split, split*2) == 'CTF{') {
             if (checkpass.substring(split*4, split*5) == 'ts_p') {
              if (checkpass.substring(split*3, split*4) == 'lien') {
                if (checkpass.substring(split*5, split*6) == 'lz_1') {
                  if (checkpass.substring(split*2, split*3) == 'no_c') {
                    if (checkpass.substring(split*7, split*8) == '9}') {
                      alert("Password Verified")
                      }
                    }
                  }
          
                }
              }
            }
          }
        }
        else {
          alert("Incorrect password");
        }
        
      }
      ```
      
      Lets break this down step by step, so we can be sure that we're understanding it.
      
      ```javascript
      
      checkpass = document.getElementById("pass").value;
      split = 4;
      ```
      
      This sets the variable `checkpass` to the value entered in the form, and also initializes the `split` variable to be equal to 4.
      
      ```javascript
      
      if (checkpass.substring(0, split) == 'pico') {
        if (checkpass.substring(split*6, split*7) == 'a3c8') {
          if (checkpass.substring(split, split*2) == 'CTF{') {
           if (checkpass.substring(split*4, split*5) == 'ts_p') {
            if (checkpass.substring(split*3, split*4) == 'lien') {
              if (checkpass.substring(split*5, split*6) == 'lz_1') {
                if (checkpass.substring(split*2, split*3) == 'no_c') {
                  if (checkpass.substring(split*7, split*8) == '9}') {
                    alert("Password Verified")
                    }
                  }
                }
        
              }
            }
          }
        }
      }
      ```
      
      On the first check, it check if the values from indexes 0 to 3 match the given string. So now we know that the flag starts with `pico`, it should be pretty easy to figure out the rest from here.
      
      Lets keep track of what each check looks for, and add it onto the flag in its respective place
      
      Check 1: `pico??????????????????????????`
      
      Check 2: `pico????????????????????a3c8??`
      
      Check 3: `picoCTF{????????????????a3c8??`
      
      Check 4: `picoCTF{????????ts_p????a3c8??`
      
      Check 5: `picoCTF{????lients_p????a3c8??`
      
      Check 6: `picoCTF{????lients_plz_1a3c8??`
      
      Check 7: `picoCTF{no_clients_plz_1a3c8??`
      
      Check 8: `picoCTF{no_clients_plz_1a3c89}`
      
      Looks like we've reconstructed the flag!
      
      FLAG: `picoCTF{no_clients_p1z_1a3c89}`
    </md-block>
  </div>
  
  <nav class="green-border" id="larger-margins">
    <ul>
      <li><a href="https://slavetomints.github.io/writeups/index.html">Home</a></li>
      <li><a href="https://slavetomints.github.io/writeups/writeups.html">Writeups</a></li>
      <li><a href="https://slavetomints.github.io/about.html">About</a></li>
    </ul>
  </nav>

  <script src="https://cdn.jsdelivr.net/npm/marked@5.1.2/marked.min.js"></script>
  <script type="module" src="https://md-block.verou.me/md-block.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-ruby.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
</body>
</html>